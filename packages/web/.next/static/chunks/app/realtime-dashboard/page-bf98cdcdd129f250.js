(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[964],{5765:function(e,s,t){Promise.resolve().then(t.bind(t,5251))},5251:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return c}});var a=t(7573),r=t(7653);function c(e){var s,t;let{params:c,searchParams:n}=e,l=(null==c?void 0:c.jobId)||(null==n?void 0:n.jobId)||"",d=(null==n?void 0:n.apiKey)||"",[o,i]=(0,r.useState)(!1),[m,x]=(0,r.useState)(null),[u,h]=(0,r.useState)([]),[g,j]=(0,r.useState)([]);(0,r.useEffect)(()=>{if(!l||!d)return;let e=new EventSource("/api/v1/realtime/reconciliations/".concat(l,"?token=").concat(encodeURIComponent(d)));return e.onopen=()=>{i(!0),v("Connected to real-time updates")},e.onmessage=s=>{try{let t=JSON.parse(s.data);"connected"===t.type?v("Connection established"):"execution_update"===t.type&&(x(t),v("Status update: ".concat(t.status)),t.error&&N(t.error),("completed"===t.status||"failed"===t.status)&&(e.close(),i(!1),v("Reconciliation finished. Connection closed.")))}catch(e){console.error("Failed to parse SSE message:",e)}},e.onerror=s=>{console.error("SSE error:",s),i(!1),v("Connection error. Attempting to reconnect..."),setTimeout(()=>{e.close(),window.location.reload()},5e3)},()=>{e.close()}},[l,d]);let v=e=>{h(s=>[...s.slice(-99),"".concat(new Date().toISOString(),": ").concat(e)])},N=e=>{j(s=>[...s.slice(-49),"".concat(new Date().toISOString(),": ").concat(e)])};return(0,a.jsxs)("div",{className:"container mx-auto p-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Reconciliation Dashboard"}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(o?"bg-green-500":"bg-red-500")}),(0,a.jsx)("span",{className:"text-sm",children:o?"Connected":"Disconnected"})]})}),m&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Execution Status"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Status:"}),(0,a.jsx)("span",{className:"ml-2 font-semibold ".concat((e=>{switch(e){case"completed":return"text-green-600";case"failed":return"text-red-600";case"running":return"text-blue-600";default:return"text-gray-600"}})(m.status)),children:null===(s=m.status)||void 0===s?void 0:s.toUpperCase()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Duration:"}),(0,a.jsx)("span",{className:"ml-2 font-semibold",children:((e,s)=>{if(!e)return"N/A";let t=new Date(e),a=Math.floor(((s?new Date(s):new Date).getTime()-t.getTime())/1e3);return"".concat(Math.floor(a/60),"m ").concat(a%60,"s")})(m.startedAt,m.completedAt)})]}),m.startedAt&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Started:"}),(0,a.jsx)("span",{className:"ml-2",children:new Date(m.startedAt).toLocaleString()})]}),m.completedAt&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Completed:"}),(0,a.jsx)("span",{className:"ml-2",children:new Date(m.completedAt).toLocaleString()})]})]}),m.summary&&(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"Summary"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Source Records"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:m.summary.total_source_records||0})]}),(0,a.jsxs)("div",{className:"bg-green-50 p-4 rounded",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Target Records"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:m.summary.total_target_records||0})]}),(0,a.jsxs)("div",{className:"bg-purple-50 p-4 rounded",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Matches"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:m.summary.matched_count||0})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 p-4 rounded",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Unmatched Source"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:m.summary.unmatched_source_count||0})]}),(0,a.jsxs)("div",{className:"bg-orange-50 p-4 rounded",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Unmatched Target"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:m.summary.unmatched_target_count||0})]}),(0,a.jsxs)("div",{className:"bg-red-50 p-4 rounded",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Errors"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:m.summary.errors_count||0})]})]}),null!==m.summary.accuracy_percentage&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-1",children:"Accuracy"}),(0,a.jsxs)("div",{className:"text-3xl font-bold text-green-600",children:[null===(t=m.summary.accuracy_percentage)||void 0===t?void 0:t.toFixed(2),"%"]})]})]})]}),g.length>0&&(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Errors"}),(0,a.jsx)("div",{className:"max-h-48 overflow-y-auto",children:g.map((e,s)=>(0,a.jsx)("div",{className:"text-sm text-red-700 mb-1",children:e},s))})]}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Activity Log"}),(0,a.jsx)("div",{className:"max-h-64 overflow-y-auto font-mono text-sm",children:u.map((e,s)=>(0,a.jsx)("div",{className:"mb-1 text-gray-700",children:e},s))})]})]})}}},function(e){e.O(0,[293,528,744],function(){return e(e.s=5765)}),_N_E=e.O()}]);