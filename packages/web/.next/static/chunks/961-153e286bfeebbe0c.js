"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[961],{2410:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SettlerClient=void 0;let n=r(6768),i=r(8608),o=r(8687),a=r(557),s=r(8944),l=r(7566),u=r(3678),c=r(6950),d=r(6560);class h{use(e){this.middlewareChain.use(e)}async request(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=async()=>{let n={method:e,path:t,headers:{},body:r.body,...void 0!==r.query&&{query:r.query}};return(await this.middlewareChain.execute(n,async e=>this.executeRequest(e))).data};return this.deduplicateRequests&&"GET"===e?(0,u.withDeduplication)(e,t,r.body,()=>(0,l.withRetry)(n,this.retryConfig)):(0,l.withRetry)(n,this.retryConfig)}async executeRequest(e){let t;let r=new URL("".concat(this.baseUrl).concat(e.path));if(e.query&&Object.entries(e.query).forEach(e=>{let[t,n]=e;r.searchParams.append(t,n)}),this.tokenManager){let e=await this.tokenManager.getToken();t="Bearer ".concat(e)}else t=this.apiKey;let n={"Content-Type":"application/json",...this.tokenManager?{Authorization:t}:{"X-API-Key":t},...e.headers},i={method:e.method,headers:n};void 0!==e.body&&null!==e.body&&(i.body=JSON.stringify(e.body));let o=new AbortController,a=setTimeout(()=>o.abort(),this.timeout);try{let e;let t=await fetch(r.toString(),{...i,signal:o.signal});clearTimeout(a);let n={};t.headers.forEach((e,t)=>{n[t]=e});let l=t.headers.get("content-type");if(e=(null==l?void 0:l.includes("application/json"))?await t.json():await t.text(),!t.ok)throw(0,s.parseError)(t,e);return{status:t.status,headers:n,data:e}}catch(e){if(clearTimeout(a),e instanceof s.SettlerError)throw e;if(e instanceof Error){if("AbortError"===e.name)throw new s.NetworkError("Request timeout after ".concat(this.timeout,"ms"));throw new s.NetworkError(e.message,e)}throw new s.NetworkError("Request failed")}}constructor(e){if(!e.apiKey)throw Error("API key is required");this.apiKey=e.apiKey,this.baseUrl=e.baseUrl||"https://api.settler.io",this.timeout=e.timeout||3e4,this.retryConfig=e.retry||{},this.deduplicateRequests=!1!==e.deduplicateRequests,e.tokenRefresh&&(this.tokenManager=new c.TokenManager(e.tokenRefresh)),this.middlewareChain=new d.MiddlewareChain,e.middleware&&e.middleware.forEach(e=>this.middlewareChain.use(e)),e.enableLogging&&this.middlewareChain.use((0,d.createLoggingMiddleware)(e.logger)),this.jobs=new n.JobsClient(this),this.reports=new i.ReportsClient(this),this.webhooks=new o.WebhooksClient(this),this.adapters=new a.AdaptersClient(this)}}t.SettlerClient=h},557:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.AdaptersClient=void 0;let n=r(5059);class i{async list(e){let t={};return(null==e?void 0:e.cursor)&&(t.cursor=e.cursor),(null==e?void 0:e.limit)&&(t.limit=String(e.limit)),this.client.request("GET","/api/v1/adapters",{query:t})}async get(e){return this.client.request("GET","/api/v1/adapters/".concat(e))}listPaginated(e){return(0,n.createPaginatedIterator)(t=>this.list({...e,...t}))}constructor(e){this.client=e}}t.AdaptersClient=i},6768:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.JobsClient=void 0;let n=r(5059);class i{async create(e){return this.client.request("POST","/api/v1/jobs",{body:e})}async list(e){let t={};return(null==e?void 0:e.cursor)&&(t.cursor=e.cursor),(null==e?void 0:e.limit)&&(t.limit=String(e.limit)),this.client.request("GET","/api/v1/jobs",{query:t})}async get(e){return this.client.request("GET","/api/v1/jobs/".concat(e))}async run(e){return this.client.request("POST","/api/v1/jobs/".concat(e,"/run"))}async delete(e){await this.client.request("DELETE","/api/v1/jobs/".concat(e))}listPaginated(e){return(0,n.createPaginatedIterator)(t=>this.list({...e,...t}))}constructor(e){this.client=e}}t.JobsClient=i},8608:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.ReportsClient=void 0;let n=r(5059);class i{async get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={};return t.startDate&&(r.startDate=t.startDate),t.endDate&&(r.endDate=t.endDate),t.format&&(r.format=t.format),this.client.request("GET","/api/v1/reports/".concat(e),{query:r})}async list(e){let t={};return(null==e?void 0:e.cursor)&&(t.cursor=e.cursor),(null==e?void 0:e.limit)&&(t.limit=String(e.limit)),this.client.request("GET","/api/v1/reports",{query:t})}listPaginated(e){return(0,n.createPaginatedIterator)(t=>this.list({...e,...t}))}constructor(e){this.client=e}}t.ReportsClient=i},8687:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.WebhooksClient=void 0;let n=r(5059);class i{async create(e){return this.client.request("POST","/api/v1/webhooks",{body:e})}async list(e){let t={};return(null==e?void 0:e.cursor)&&(t.cursor=e.cursor),(null==e?void 0:e.limit)&&(t.limit=String(e.limit)),this.client.request("GET","/api/v1/webhooks",{query:t})}async get(e){return this.client.request("GET","/api/v1/webhooks/".concat(e))}async delete(e){await this.client.request("DELETE","/api/v1/webhooks/".concat(e))}listPaginated(e){return(0,n.createPaginatedIterator)(t=>this.list({...e,...t}))}constructor(e){this.client=e}}t.WebhooksClient=i},8944:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.UnknownError=t.ServerError=t.RateLimitError=t.ValidationError=t.AuthError=t.NetworkError=t.SettlerError=void 0,t.parseError=function(e,t){let n=e.status,l="object"==typeof t&&null!==t?t:{},u=l.message||l.error||"HTTP ".concat(n,": ").concat(e.statusText);switch(n){case 400:return new o(u,void 0,n,l.details);case 401:case 403:return new i(u,n,l.details);case 429:{let t=e.headers.get("Retry-After"),r=e.headers.get("X-RateLimit-Limit"),n=e.headers.get("X-RateLimit-Remaining"),i=e.headers.get("X-RateLimit-Reset");return new a(u,t?parseInt(t,10):void 0,r?parseInt(r,10):void 0,n?parseInt(n,10):void 0,i?parseInt(i,10):void 0)}case 500:case 502:case 503:case 504:return new s(u,n,l.details);default:return new r(u,"API_ERROR",n,l.details)}};class r extends Error{constructor(e,t,r,n){var i,o;super(e),this.name=this.constructor.name,this.code=t,void 0!==r&&(this.statusCode=r),void 0!==n&&(this.details=n),null===(i=(o=Error).captureStackTrace)||void 0===i||i.call(o,this,this.constructor)}}t.SettlerError=r;class n extends r{constructor(e,t){super(e,"NETWORK_ERROR",void 0,{cause:t}),this.name="NetworkError"}}t.NetworkError=n;class i extends r{constructor(e,t,r){super(e,"AUTH_ERROR",t||401,r),this.name="AuthError"}}t.AuthError=i;class o extends r{constructor(e,t,r,n){super(e,"VALIDATION_ERROR",r||400,n),this.name="ValidationError",void 0!==t&&(this.field=t)}}t.ValidationError=o;class a extends r{constructor(e,t,r,n,i){super(e,"RATE_LIMIT_ERROR",429),this.name="RateLimitError",void 0!==t&&(this.retryAfter=t),void 0!==r&&(this.limit=r),void 0!==n&&(this.remaining=n),void 0!==i&&(this.reset=i)}}t.RateLimitError=a;class s extends r{constructor(e,t,r){super(e,"SERVER_ERROR",t||500,r),this.name="ServerError"}}t.ServerError=s;class l extends r{constructor(e,t){super(e,"UNKNOWN_ERROR",void 0,{cause:t}),this.name="UnknownError"}}t.UnknownError=l},6961:function(e,t,r){var n=Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};Object.defineProperty(t,"__esModule",{value:!0}),t.AdaptersClient=t.WebhooksClient=t.ReportsClient=t.JobsClient=t.SettlerClient=t.withRetry=t.createMetricsMiddleware=t.createLoggingMiddleware=t.MiddlewareChain=t.TokenManager=t.extractWebhookTimestamp=t.verifyWebhookSignatureWithTimestamp=t.verifyWebhookSignature=t.PaginatedIterator=t.collectPaginated=t.createPaginatedIterator=t.parseError=t.UnknownError=t.ServerError=t.RateLimitError=t.ValidationError=t.AuthError=t.NetworkError=t.SettlerError=void 0;let i=r(2410);Object.defineProperty(t,"SettlerClient",{enumerable:!0,get:function(){return i.SettlerClient}});let o=r(6768);Object.defineProperty(t,"JobsClient",{enumerable:!0,get:function(){return o.JobsClient}});let a=r(8608);Object.defineProperty(t,"ReportsClient",{enumerable:!0,get:function(){return a.ReportsClient}});let s=r(8687);Object.defineProperty(t,"WebhooksClient",{enumerable:!0,get:function(){return s.WebhooksClient}});let l=r(557);Object.defineProperty(t,"AdaptersClient",{enumerable:!0,get:function(){return l.AdaptersClient}}),function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)}(r(6312),t);var u=r(8944);Object.defineProperty(t,"SettlerError",{enumerable:!0,get:function(){return u.SettlerError}}),Object.defineProperty(t,"NetworkError",{enumerable:!0,get:function(){return u.NetworkError}}),Object.defineProperty(t,"AuthError",{enumerable:!0,get:function(){return u.AuthError}}),Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return u.ValidationError}}),Object.defineProperty(t,"RateLimitError",{enumerable:!0,get:function(){return u.RateLimitError}}),Object.defineProperty(t,"ServerError",{enumerable:!0,get:function(){return u.ServerError}}),Object.defineProperty(t,"UnknownError",{enumerable:!0,get:function(){return u.UnknownError}}),Object.defineProperty(t,"parseError",{enumerable:!0,get:function(){return u.parseError}});var c=r(5059);Object.defineProperty(t,"createPaginatedIterator",{enumerable:!0,get:function(){return c.createPaginatedIterator}}),Object.defineProperty(t,"collectPaginated",{enumerable:!0,get:function(){return c.collectPaginated}}),Object.defineProperty(t,"PaginatedIterator",{enumerable:!0,get:function(){return c.PaginatedIterator}});var d=r(970);Object.defineProperty(t,"verifyWebhookSignature",{enumerable:!0,get:function(){return d.verifyWebhookSignature}}),Object.defineProperty(t,"verifyWebhookSignatureWithTimestamp",{enumerable:!0,get:function(){return d.verifyWebhookSignatureWithTimestamp}}),Object.defineProperty(t,"extractWebhookTimestamp",{enumerable:!0,get:function(){return d.extractWebhookTimestamp}});var h=r(6950);Object.defineProperty(t,"TokenManager",{enumerable:!0,get:function(){return h.TokenManager}});var f=r(6560);Object.defineProperty(t,"MiddlewareChain",{enumerable:!0,get:function(){return f.MiddlewareChain}}),Object.defineProperty(t,"createLoggingMiddleware",{enumerable:!0,get:function(){return f.createLoggingMiddleware}}),Object.defineProperty(t,"createMetricsMiddleware",{enumerable:!0,get:function(){return f.createMetricsMiddleware}});var m=r(7566);Object.defineProperty(t,"withRetry",{enumerable:!0,get:function(){return m.withRetry}}),t.default=i.SettlerClient},6312:function(e,t){Object.defineProperty(t,"__esModule",{value:!0})},3678:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.withDeduplication=n,t.clearPendingRequests=function(){r.clear()};let r=new Map;async function n(e,t,n,i){!function(){let e=Date.now();for(let[t,n]of r.entries())e-n.timestamp>6e4&&r.delete(t)}();let o=function(e,t,r){let n=r?JSON.stringify(r):"";return"".concat(e,":").concat(t,":").concat(n)}(e,t,n),a=r.get(o);if(a)return a.promise;let s=i().finally(()=>{r.delete(o)});return r.set(o,{promise:s,timestamp:Date.now()}),s}},6560:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MiddlewareChain=void 0,t.createLoggingMiddleware=function(e){let t=(null==e?void 0:e.info)||console.log,r=(null==e?void 0:e.error)||console.error;return async(e,n)=>{let i=Date.now();t("[Settler SDK] ".concat(e.method," ").concat(e.path),{method:e.method,path:e.path,headers:e.headers});try{let r=await n(),o=Date.now()-i;return t("[Settler SDK] ".concat(e.method," ").concat(e.path," ").concat(r.status," (").concat(o,"ms)"),{method:e.method,path:e.path,status:r.status,duration:o}),r}catch(n){let t=Date.now()-i;throw r("[Settler SDK] ".concat(e.method," ").concat(e.path," ERROR (").concat(t,"ms)"),{method:e.method,path:e.path,error:n,duration:t}),n}}},t.createMetricsMiddleware=function(e){return async(t,r)=>{var n,i,o,a,s;let l=Date.now();null==e||null===(n=e.increment)||void 0===n||n.call(e,"settler.request.started",{method:t.method,path:t.path});try{let n=await r(),a=Date.now()-l;return null==e||null===(i=e.histogram)||void 0===i||i.call(e,"settler.request.duration",a,{method:t.method,path:t.path,status:String(n.status)}),null==e||null===(o=e.increment)||void 0===o||o.call(e,"settler.request.completed",{method:t.method,path:t.path,status:String(n.status)}),n}catch(n){let r=Date.now()-l;throw null==e||null===(a=e.histogram)||void 0===a||a.call(e,"settler.request.duration",r,{method:t.method,path:t.path,status:"error"}),null==e||null===(s=e.increment)||void 0===s||s.call(e,"settler.request.failed",{method:t.method,path:t.path}),n}}};class r{use(e){this.middlewares.push(e)}async execute(e,t){let r=0,n=async()=>{if(r>=this.middlewares.length)return t(e);let i=this.middlewares[r++];return i?i(e,n):t(e)};return n()}constructor(){this.middlewares=[]}}t.MiddlewareChain=r},5059:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PaginatedIterator=void 0,t.createPaginatedIterator=function(e){return new r(e)},t.collectPaginated=n;class r{async next(){if(this.currentIndex<this.currentPage.length){let e=this.currentPage[this.currentIndex++];if(void 0!==e)return{done:!1,value:e}}if(!this.hasMore)return{done:!0,value:void 0};try{var e;let t={};void 0!==this.currentCursor&&(t.cursor=this.currentCursor);let r=await this.fetchPage(t);if(this.currentPage=r.data,this.currentIndex=0,void 0!==r.nextCursor&&(this.currentCursor=r.nextCursor),this.hasMore=null!==(e=r.hasMore)&&void 0!==e?e:void 0!==r.nextCursor,0===this.currentPage.length)return{done:!0,value:void 0};let n=this.currentPage[this.currentIndex++];if(void 0!==n)return{done:!1,value:n};return{done:!0,value:void 0}}catch(e){throw e}}[Symbol.asyncIterator](){return this}constructor(e){this.currentPage=[],this.currentIndex=0,this.hasMore=!0,this.fetchPage=e}}async function n(e){let t=[];for await(let r of e)t.push(r);return t}t.PaginatedIterator=r},7566:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.withRetry=o;let n=r(8944),i={maxRetries:3,initialDelay:1e3,maxDelay:3e4,multiplier:2,retryOnRateLimit:!0,shouldRetry:()=>!0};async function o(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o={...i,...r};for(let r=0;r<=o.maxRetries;r++)try{return await e()}catch(a){let e;if(t=a instanceof n.SettlerError?a:new n.NetworkError(String(a),a),r===o.maxRetries)break;let i=t instanceof n.NetworkError||t instanceof n.RateLimitError&&o.retryOnRateLimit||void 0!==t.statusCode&&t.statusCode>=500;if(!(o.shouldRetry(t,r)&&i))break;e=t instanceof n.RateLimitError&&t.retryAfter?1e3*t.retryAfter:function(e,t,r,n){let i=t*Math.pow(n,e);return Math.min(i+.1*Math.random()*i,r)}(r,o.initialDelay,o.maxDelay,o.multiplier),await function(e){return new Promise(t=>setTimeout(t,e))}(e)}throw t}},6950:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TokenManager=void 0;class r{async getToken(){let e=Date.now();if(!this.tokenInfo||this.tokenInfo.expiresAt-e<this.config.refreshThreshold){if(this.refreshPromise)return this.tokenInfo=await this.refreshPromise,this.refreshPromise=null,this.tokenInfo.token;this.refreshPromise=this.config.refreshFn();try{return this.tokenInfo=await this.refreshPromise,this.refreshPromise=null,this.tokenInfo.token}catch(e){throw this.refreshPromise=null,e}}if(!this.tokenInfo)throw Error("Token is not available");return this.tokenInfo.token}setToken(e){this.tokenInfo=e}clearToken(){this.tokenInfo=null,this.refreshPromise=null}constructor(e){var t;this.tokenInfo=null,this.refreshPromise=null,this.config={refreshThreshold:null!==(t=e.refreshThreshold)&&void 0!==t?t:3e5,refreshFn:e.refreshFn}}}t.TokenManager=r},970:function(e,t,r){var n=r(7376).Buffer;function i(e,t,i){if(!t||!i)return!1;let o=t.split(",").find(e=>e.startsWith("v1="));if(!o)return!1;let a=o.substring(3);try{let t;let o=function(){try{return r(6736)}catch(e){}throw Error("Webhook signature verification requires Node.js crypto module or a crypto library")}(),s=o.createHmac("sha256",i);t="string"==typeof e?e:n.isBuffer(e)?e.toString():e instanceof ArrayBuffer?n.from(e).toString():String(e),s.update(t);let l=s.digest("hex");if(o.timingSafeEqual)return o.timingSafeEqual(n.from(a,"hex"),n.from(l,"hex"));if(a.length!==l.length)return!1;let u=0;for(let e=0;e<a.length;e++)u|=a.charCodeAt(e)^l.charCodeAt(e);return 0===u}catch(e){return!1}}function o(e){let t=e.split(",").find(e=>e.startsWith("t="));if(!t)return null;let r=parseInt(t.substring(2),10);return isNaN(r)?null:1e3*r}Object.defineProperty(t,"__esModule",{value:!0}),t.verifyWebhookSignature=i,t.extractWebhookTimestamp=o,t.verifyWebhookSignatureWithTimestamp=function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3e5;if(!i(e,t,r))return!1;let a=o(t);if(!a)return!1;let s=Date.now()-a;return s>=0&&s<=n}}}]);