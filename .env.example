# ============================================================================
# Settler API Environment Variables
# ============================================================================
# Copy this file to .env and fill in your values
# NEVER commit .env files with real secrets to version control
# 
# This file documents ALL environment variables used across the platform.
# See config/env.schema.ts for detailed specifications.
# ============================================================================

# ----------------------------------------------------------------------------
# CORE CONFIGURATION
# ----------------------------------------------------------------------------
NODE_ENV=development
DEPLOYMENT_ENV=local
PORT=3000
HOST=0.0.0.0

# ----------------------------------------------------------------------------
# DATABASE CONFIGURATION (Supabase/PostgreSQL)
# ----------------------------------------------------------------------------
# Supabase Configuration (Primary - Recommended for Production)
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key-here
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here
SUPABASE_REALTIME_EVENTS_PER_SECOND=10

# PostgreSQL Configuration (Fallback for Local Development)
# Use these if not using Supabase
DB_HOST=localhost
DB_PORT=5432
DB_NAME=settler
DB_USER=postgres
DB_PASSWORD=postgres
DB_SSL=false
DB_POOL_MIN=5
DB_POOL_MAX=20
DB_CONNECTION_TIMEOUT=2000
DB_STATEMENT_TIMEOUT=30000

# Alternative: PostgreSQL Connection String
# DATABASE_URL=postgresql://user:password@host:port/database

# ----------------------------------------------------------------------------
# REDIS CONFIGURATION (Upstash)
# ----------------------------------------------------------------------------
# Upstash Redis Configuration (Serverless - Recommended for Production)
UPSTASH_REDIS_REST_URL=https://your-redis.upstash.io
UPSTASH_REDIS_REST_TOKEN=your-upstash-token-here

# Fallback Redis Configuration (for local development)
REDIS_URL=redis://localhost:6379
REDIS_TOKEN=
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_TLS=false
REDIS_DB=0

# Redis Cache Configuration
REDIS_CACHE_TTL=3600
REDIS_RECONCILIATION_TTL=300

# ----------------------------------------------------------------------------
# SECURITY & AUTHENTICATION
# ----------------------------------------------------------------------------
# JWT Configuration
# IMPORTANT: Generate secure random secrets for production (min 32 chars)
JWT_SECRET=dev-secret-change-in-production-min-32-chars-long-required
JWT_ACCESS_EXPIRY=15m
JWT_REFRESH_EXPIRY=7d
JWT_REFRESH_SECRET=dev-refresh-secret-change-in-production-min-32-chars

# Encryption Configuration
# IMPORTANT: Must be exactly 32 characters for AES-256-GCM
ENCRYPTION_KEY=dev-encryption-key-32-chars-long!!

# CORS Configuration (comma-separated URLs, or * for all)
# WARNING: * allows all origins. Restrict in production.
ALLOWED_ORIGINS=*

# Security Configuration
TRUST_PROXY=false
SECURE_COOKIES=false

# ----------------------------------------------------------------------------
# OBSERVABILITY (Sentry)
# ----------------------------------------------------------------------------
# Sentry Configuration (Optional but Recommended for Production)
# SENTRY_DSN=https://your-key@sentry.io/your-project-id
# SENTRY_ENVIRONMENT=development
# SENTRY_TRACES_SAMPLE_RATE=0.1
# SENTRY_ENABLE_DEV=false

# OpenTelemetry Configuration (Optional)
# OTLP_ENDPOINT=https://your-otlp-endpoint.com
# JAEGER_ENDPOINT=https://your-jaeger-endpoint.com

# Service Identification
SERVICE_NAME=settler-api

# ----------------------------------------------------------------------------
# LOGGING & MONITORING
# ----------------------------------------------------------------------------
LOG_LEVEL=info
LOG_SAMPLING_RATE=1.0
METRICS_ENABLED=true
HEALTH_CHECK_ENABLED=true

# ----------------------------------------------------------------------------
# RATE LIMITING & PERFORMANCE
# ----------------------------------------------------------------------------
RATE_LIMIT_DEFAULT=1000
RATE_LIMIT_WINDOW_MS=900000

# ----------------------------------------------------------------------------
# WEBHOOK CONFIGURATION
# ----------------------------------------------------------------------------
WEBHOOK_MAX_RETRIES=5
WEBHOOK_INITIAL_DELAY=2000
WEBHOOK_MAX_DELAY=32000

# ----------------------------------------------------------------------------
# DATA RETENTION
# ----------------------------------------------------------------------------
DATA_RETENTION_DAYS=365

# ----------------------------------------------------------------------------
# FEATURE FLAGS
# ----------------------------------------------------------------------------
ENABLE_SCHEMA_PER_TENANT=false
ENABLE_REQUEST_TIMEOUT=true
ENABLE_API_DOCS=true

# ----------------------------------------------------------------------------
# THIRD-PARTY INTEGRATIONS (Adapter Configs)
# ----------------------------------------------------------------------------
# These are typically set per-job in reconciliation config, not globally.
# Included here for reference only.

# Stripe Configuration (for Stripe adapter)
# STRIPE_SECRET_KEY=sk_test_your_stripe_key

# Shopify Configuration (for Shopify adapter)
# SHOPIFY_API_KEY=your_shopify_api_key

# ----------------------------------------------------------------------------
# CI/CD CONFIGURATION
# ----------------------------------------------------------------------------
# These are set in GitHub Actions secrets or Vercel environment variables.
# Do NOT set these in .env files.

# Vercel Deployment (GitHub Actions secrets)
# VERCEL_TOKEN=your-vercel-token
# VERCEL_ORG_ID=your-org-id
# VERCEL_PROJECT_ID=your-project-id

# Security Scanning (GitHub Actions secrets)
# SNYK_TOKEN=your-snyk-token

# E2E Testing (GitHub Actions)
# E2E_API_KEY=test-api-key
# E2E_BASE_URL=http://localhost:3000
